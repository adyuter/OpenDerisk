"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2925],{15381:function(e,t,l){l.d(t,{Z:function(){return c}});var a=l(87462),n=l(67294),s={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M885.9 490.3c3.6-12 5.4-24.4 5.4-37 0-28.3-9.3-55.5-26.1-77.7 3.6-12 5.4-24.4 5.4-37 0-28.3-9.3-55.5-26.1-77.7 3.6-12 5.4-24.4 5.4-37 0-51.6-30.7-98.1-78.3-118.4a66.1 66.1 0 00-26.5-5.4H144c-17.7 0-32 14.3-32 32v364c0 17.7 14.3 32 32 32h129.3l85.8 310.8C372.9 889 418.9 924 470.9 924c29.7 0 57.4-11.8 77.9-33.4 20.5-21.5 31-49.7 29.5-79.4l-6-122.9h239.9c12.1 0 23.9-3.2 34.3-9.3 40.4-23.5 65.5-66.1 65.5-111 0-28.3-9.3-55.5-26.1-77.7zM184 456V172h81v284h-81zm627.2 160.4H496.8l9.6 198.4c.6 11.9-4.7 23.1-14.6 30.5-6.1 4.5-13.6 6.8-21.1 6.7a44.28 44.28 0 01-42.2-32.3L329 459.2V172h415.4a56.85 56.85 0 0133.6 51.8c0 9.7-2.3 18.9-6.9 27.3l-13.9 25.4 21.9 19a56.76 56.76 0 0119.6 43c0 9.7-2.3 18.9-6.9 27.3l-13.9 25.4 21.9 19a56.76 56.76 0 0119.6 43c0 9.7-2.3 18.9-6.9 27.3l-14 25.5 21.9 19a56.76 56.76 0 0119.6 43c0 19.1-11 37.5-28.8 48.4z"}}]},name:"dislike",theme:"outlined"},r=l(84089),c=n.forwardRef(function(e,t){return n.createElement(r.Z,(0,a.Z)({},e,{ref:t,icon:s}))})},65429:function(e,t,l){l.d(t,{Z:function(){return c}});var a=l(87462),n=l(67294),s={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M885.9 533.7c16.8-22.2 26.1-49.4 26.1-77.7 0-44.9-25.1-87.4-65.5-111.1a67.67 67.67 0 00-34.3-9.3H572.4l6-122.9c1.4-29.7-9.1-57.9-29.5-79.4A106.62 106.62 0 00471 99.9c-52 0-98 35-111.8 85.1l-85.9 311H144c-17.7 0-32 14.3-32 32v364c0 17.7 14.3 32 32 32h601.3c9.2 0 18.2-1.8 26.5-5.4 47.6-20.3 78.3-66.8 78.3-118.4 0-12.6-1.8-25-5.4-37 16.8-22.2 26.1-49.4 26.1-77.7 0-12.6-1.8-25-5.4-37 16.8-22.2 26.1-49.4 26.1-77.7-.2-12.6-2-25.1-5.6-37.1zM184 852V568h81v284h-81zm636.4-353l-21.9 19 13.9 25.4a56.2 56.2 0 016.9 27.3c0 16.5-7.2 32.2-19.6 43l-21.9 19 13.9 25.4a56.2 56.2 0 016.9 27.3c0 16.5-7.2 32.2-19.6 43l-21.9 19 13.9 25.4a56.2 56.2 0 016.9 27.3c0 22.4-13.2 42.6-33.6 51.8H329V564.8l99.5-360.5a44.1 44.1 0 0142.2-32.3c7.6 0 15.1 2.2 21.1 6.7 9.9 7.4 15.2 18.6 14.6 30.5l-9.6 198.4h314.4C829 418.5 840 436.9 840 456c0 16.5-7.2 32.1-19.6 43z"}}]},name:"like",theme:"outlined"},r=l(84089),c=n.forwardRef(function(e,t){return n.createElement(r.Z,(0,a.Z)({},e,{ref:t,icon:s}))})},99134:function(e,t,l){var a=l(67294);let n=(0,a.createContext)({});t.Z=n},21584:function(e,t,l){var a=l(67294),n=l(93967),s=l.n(n),r=l(53124),c=l(99134),i=l(6999),o=function(e,t){var l={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&0>t.indexOf(a)&&(l[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var n=0,a=Object.getOwnPropertySymbols(e);n<a.length;n++)0>t.indexOf(a[n])&&Object.prototype.propertyIsEnumerable.call(e,a[n])&&(l[a[n]]=e[a[n]]);return l};function u(e){return"number"==typeof e?`${e} ${e} auto`:/^\d+(\.\d+)?(px|em|rem|%)$/.test(e)?`0 0 ${e}`:e}let d=["xs","sm","md","lg","xl","xxl"],f=a.forwardRef((e,t)=>{let{getPrefixCls:l,direction:n}=a.useContext(r.E_),{gutter:f,wrap:x}=a.useContext(c.Z),{prefixCls:p,span:m,order:h,offset:g,push:v,pull:y,className:j,children:b,flex:w,style:$}=e,C=o(e,["prefixCls","span","order","offset","push","pull","className","children","flex","style"]),N=l("col",p),[k,O,_]=(0,i.cG)(N),Z={},S={};d.forEach(t=>{let l={},a=e[t];"number"==typeof a?l.span=a:"object"==typeof a&&(l=a||{}),delete C[t],S=Object.assign(Object.assign({},S),{[`${N}-${t}-${l.span}`]:void 0!==l.span,[`${N}-${t}-order-${l.order}`]:l.order||0===l.order,[`${N}-${t}-offset-${l.offset}`]:l.offset||0===l.offset,[`${N}-${t}-push-${l.push}`]:l.push||0===l.push,[`${N}-${t}-pull-${l.pull}`]:l.pull||0===l.pull,[`${N}-rtl`]:"rtl"===n}),l.flex&&(S[`${N}-${t}-flex`]=!0,Z[`--${N}-${t}-flex`]=u(l.flex))});let E=s()(N,{[`${N}-${m}`]:void 0!==m,[`${N}-order-${h}`]:h,[`${N}-offset-${g}`]:g,[`${N}-push-${v}`]:v,[`${N}-pull-${y}`]:y},j,S,O,_),M={};if(f&&f[0]>0){let e=f[0]/2;M.paddingLeft=e,M.paddingRight=e}return w&&(M.flex=u(w),!1!==x||M.minWidth||(M.minWidth=0)),k(a.createElement("div",Object.assign({},C,{style:Object.assign(Object.assign(Object.assign({},M),$),Z),className:E,ref:t}),b))});t.Z=f},17621:function(e,t,l){l.d(t,{Z:function(){return p}});var a=l(67294),n=l(93967),s=l.n(n),r=l(74443),c=l(53124),i=l(25378),o=l(99134),u=l(6999),d=function(e,t){var l={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&0>t.indexOf(a)&&(l[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var n=0,a=Object.getOwnPropertySymbols(e);n<a.length;n++)0>t.indexOf(a[n])&&Object.prototype.propertyIsEnumerable.call(e,a[n])&&(l[a[n]]=e[a[n]]);return l};function f(e,t){let[l,n]=a.useState("string"==typeof e?e:""),s=()=>{if("string"==typeof e&&n(e),"object"==typeof e)for(let l=0;l<r.c4.length;l++){let a=r.c4[l];if(!t||!t[a])continue;let s=e[a];if(void 0!==s){n(s);return}}};return a.useEffect(()=>{s()},[JSON.stringify(e),t]),l}let x=a.forwardRef((e,t)=>{let{prefixCls:l,justify:n,align:x,className:p,style:m,children:h,gutter:g=0,wrap:v}=e,y=d(e,["prefixCls","justify","align","className","style","children","gutter","wrap"]),{getPrefixCls:j,direction:b}=a.useContext(c.E_),w=(0,i.Z)(!0,null),$=f(x,w),C=f(n,w),N=j("row",l),[k,O,_]=(0,u.VM)(N),Z=function(e,t){let l=[void 0,void 0],a=Array.isArray(e)?e:[e,void 0],n=t||{xs:!0,sm:!0,md:!0,lg:!0,xl:!0,xxl:!0};return a.forEach((e,t)=>{if("object"==typeof e&&null!==e)for(let a=0;a<r.c4.length;a++){let s=r.c4[a];if(n[s]&&void 0!==e[s]){l[t]=e[s];break}}else l[t]=e}),l}(g,w),S=s()(N,{[`${N}-no-wrap`]:!1===v,[`${N}-${C}`]:C,[`${N}-${$}`]:$,[`${N}-rtl`]:"rtl"===b},p,O,_),E={},M=null!=Z[0]&&Z[0]>0?-(Z[0]/2):void 0;M&&(E.marginLeft=M,E.marginRight=M);let[P,z]=Z;E.rowGap=z;let V=a.useMemo(()=>({gutter:[P,z],wrap:v}),[P,z,v]);return k(a.createElement(o.Z.Provider,{value:V},a.createElement("div",Object.assign({},y,{className:S,style:Object.assign(Object.assign({},E),m),ref:t}),h)))});var p=x},7332:function(e,t,l){l.r(t);var a=l(85893),n=l(39718),s=l(18102),r=l(96074),c=l(93967),i=l.n(c),o=l(67294),u=l(23820),d=l(32966);t.default=(0,o.memo)(e=>{let{message:t,index:l}=e,{scene:c}=(0,o.useContext)(u.MobileChatContext),{context:f,model_name:x,role:p,thinking:m}=t,h=(0,o.useMemo)(()=>"view"===p,[p]),g=(0,o.useRef)(null),{value:v}=(0,o.useMemo)(()=>{if("string"!=typeof f)return{relations:[],value:"",cachePluginContext:[]};let[e,t]=f.split("	relations:"),l=t?t.split(","):[],a=[],n=0,s=e.replace(/<derisk-view[^>]*>[^<]*<\/derisk-view>/gi,e=>{try{var t;let l=e.replaceAll("\n","\\n").replace(/<[^>]*>|<\/[^>]*>/gm,""),s=JSON.parse(l),r="<custom-view>".concat(n,"</custom-view>");return a.push({...s,result:y(null!==(t=s.result)&&void 0!==t?t:"")}),n++,r}catch(t){return console.log(t.message,t),e}});return{relations:l,cachePluginContext:a,value:s}},[f]),y=e=>e.replaceAll("\\n","\n").replace(/<table(\w*=[^>]+)>/gi,"<table $1>").replace(/<tr(\w*=[^>]+)>/gi,"<tr $1>");return(0,a.jsxs)("div",{className:i()("flex w-full",{"justify-end":!h}),ref:g,children:[!h&&(0,a.jsx)("div",{className:"flex bg-[#0C75FC]  text-white p-3 rounded-xl rounded-br-none",children:f}),h&&(0,a.jsxs)("div",{className:"flex max-w-full flex-col flex-wrap bg-white dark:bg-[rgba(255,255,255,0.16)] p-3 rounded-xl rounded-bl-none",children:["string"==typeof f&&"chat_agent"===c&&(0,a.jsx)(s.default,{children:null==v?void 0:v.replace(/<table(\w*=[^>]+)>/gi,"<table $1>").replace(/<tr(\w*=[^>]+)>/gi,"<tr $1>")}),"string"==typeof f&&"chat_agent"!==c&&(0,a.jsx)(s.default,{children:y(v)}),m&&!f&&(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:"flex text-sm text-[#1c2533] dark:text-white",children:"思考中"}),(0,a.jsxs)("div",{className:"flex",children:[(0,a.jsx)("div",{className:"w-1 h-1 rounded-full mx-1 animate-pulse1"}),(0,a.jsx)("div",{className:"w-1 h-1 rounded-full mx-1 animate-pulse2"}),(0,a.jsx)("div",{className:"w-1 h-1 rounded-full mx-1 animate-pulse3"})]})]}),!m&&(0,a.jsx)(r.Z,{className:"my-2"}),(0,a.jsxs)("div",{className:i()("opacity-0 h-0 w-0",{"opacity-100 flex items-center justify-between gap-6 w-auto h-auto":!m}),children:[(0,a.jsx)(d.default,{content:t,index:l,chatDialogRef:g}),"chat_agent"!==c&&(0,a.jsxs)("div",{className:"flex gap-1 items-center",children:[(0,a.jsx)(n.Z,{width:14,height:14,model:x}),(0,a.jsx)("span",{className:"text-xs text-gray-500",children:x})]})]})]})]})})},36818:function(e,t,l){l.r(t);var a=l(85893),n=l(67294),s=l(23820),r=l(7332);t.default=(0,n.memo)(()=>{let{history:e}=(0,n.useContext)(s.MobileChatContext),t=(0,n.useMemo)(()=>e.filter(e=>["view","human"].includes(e.role)),[e]);return(0,a.jsx)("div",{className:"flex flex-col gap-4",children:!!t.length&&t.map((e,t)=>(0,a.jsx)(r.default,{message:e,index:t},e.context+t))})})},5583:function(e,t,l){l.r(t);var a=l(85893),n=l(85265),s=l(66309),r=l(38289),c=l(77683),i=l(67294);t.default=e=>{let{open:t,setFeedbackOpen:l,list:o,feedback:u,loading:d}=e,[f,x]=(0,i.useState)([]),[p,m]=(0,i.useState)("");return(0,a.jsx)(n.Z,{title:"你的反馈助我进步",placement:"bottom",open:t,onClose:()=>l(!1),destroyOnClose:!0,height:"auto",children:(0,a.jsxs)("div",{className:"flex flex-col w-full gap-4",children:[(0,a.jsx)("div",{className:"flex w-full flex-wrap gap-2",children:null==o?void 0:o.map(e=>{let t=f.findIndex(t=>t.reason_type===e.reason_type)>-1;return(0,a.jsx)(s.Z,{className:"text-sm text-[#525964] p-1 px-2 rounded-md cursor-pointer ".concat(t?"border-[#0c75fc] text-[#0c75fc]":""),onClick:()=>{x(t=>{let l=t.findIndex(t=>t.reason_type===e.reason_type);return l>-1?[...t.slice(0,l),...t.slice(l+1)]:[...t,e]})},children:e.reason},e.reason_type)})}),(0,a.jsx)(r.default.TextArea,{placeholder:"描述一下具体问题或更优的答案",className:"h-24 resize-none mb-2",value:p,onChange:e=>m(e.target.value.trim())}),(0,a.jsxs)("div",{className:"flex gap-2 justify-end",children:[(0,a.jsx)(c.ZP,{className:"w-16 h-8",onClick:()=>{l(!1)},children:"取消"}),(0,a.jsx)(c.ZP,{type:"primary",className:"min-w-16 h-8",onClick:async()=>{let e=f.map(e=>e.reason_type);await (null==u?void 0:u({feedback_type:"unlike",reason_types:e,remark:p}))},loading:d,children:"确认"})]})]})})}},32966:function(e,t,l){l.r(t);var a=l(85893),n=l(60778),s=l(65429),r=l(15381),c=l(57132),i=l(65654),o=l(36447),u=l(96074),d=l(77683),f=l(93967),x=l.n(f),p=l(20640),m=l.n(p),h=l(67294),g=l(23820),v=l(5583);t.default=e=>{var t;let{content:l,index:f,chatDialogRef:p}=e,{conv_uid:y,history:j,scene:b}=(0,h.useContext)(g.MobileChatContext),{message:w}=o.Z.useApp(),[$,C]=(0,h.useState)(!1),[N,k]=(0,h.useState)(null==l?void 0:null===(t=l.feedback)||void 0===t?void 0:t.feedback_type),[O,_]=(0,h.useState)([]),Z=async e=>{var t;let l=null==e?void 0:e.replace(/\trelations:.*/g,""),a=m()((null===(t=p.current)||void 0===t?void 0:t.textContent)||l);a?l?w.success("复制成功"):w.warning("内容复制为空"):w.error("复制失败")},{run:S,loading:E}=(0,i.Z)(async e=>await (0,n.Vx)((0,n.zx)({conv_uid:y,message_id:l.order+"",feedback_type:e.feedback_type,reason_types:e.reason_types,remark:e.remark})),{manual:!0,onSuccess:e=>{let[,t]=e;k(null==t?void 0:t.feedback_type),w.success("反馈成功"),C(!1)}}),{run:M}=(0,i.Z)(async()=>await (0,n.Vx)((0,n.Ir)({conv_uid:y,message_id:(null==l?void 0:l.order)+""})),{manual:!0,onSuccess:e=>{let[,t]=e;t&&(k("none"),w.success("操作成功"))}}),{run:P}=(0,i.Z)(async()=>await (0,n.Vx)((0,n.Jr)()),{manual:!0,onSuccess:e=>{let[,t]=e;_(t||[]),t&&C(!0)}}),{run:z,loading:V}=(0,i.Z)(async()=>await (0,n.Vx)((0,n.Ty)({conv_id:y,round_index:0})),{manual:!0,onSuccess:()=>{w.success("操作成功")}});return(0,a.jsxs)("div",{className:"flex items-center text-sm",children:[(0,a.jsxs)("div",{className:"flex gap-3",children:[(0,a.jsx)(s.Z,{className:x()("cursor-pointer",{"text-[#0C75FC]":"like"===N}),onClick:async()=>{if("like"===N){await M();return}await S({feedback_type:"like"})}}),(0,a.jsx)(r.Z,{className:x()("cursor-pointer",{"text-[#0C75FC]":"unlike"===N}),onClick:async()=>{if("unlike"===N){await M();return}await P()}}),(0,a.jsx)(v.default,{open:$,setFeedbackOpen:C,list:O,feedback:S,loading:E})]}),(0,a.jsx)(u.Z,{type:"vertical"}),(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)(c.Z,{className:"cursor-pointer",onClick:()=>Z(l.context)}),j.length-1===f&&"chat_agent"===b&&(0,a.jsx)(d.ZP,{loading:V,size:"small",onClick:async()=>{await z()},className:"text-xs",children:"终止话题"})]})]})}}}]);