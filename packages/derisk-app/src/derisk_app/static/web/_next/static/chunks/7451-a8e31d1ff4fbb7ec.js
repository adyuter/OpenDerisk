"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7451,952],{91085:function(e,l,a){var t=a(85893),r=a(32983),i=a(77683),n=a(93967),s=a.n(n),u=a(67421);l.Z=function(e){let{className:l,error:a,description:n,refresh:o}=e,{t:d}=(0,u.$G)();return(0,t.jsx)(r.Z,{image:"/empty.png",imageStyle:{width:320,height:196,margin:"0 auto",maxWidth:"100%",maxHeight:"100%"},className:s()("flex items-center justify-center flex-col h-full w-full",l),description:a?(0,t.jsx)(i.ZP,{type:"primary",onClick:o,children:d("try_again")}):null!=n?n:d("no_data")})}},98198:function(e,l,a){a.d(l,{Z:function(){return m}});var t=a(85893),r=a(65217),i=a(38289),n=a(24435),s=a(84567),u=a(99859),o=a(67294),d=e=>{let{parentName:l,fields:a,form:d}=e,[c,m]=(0,o.useState)(null);(0,o.useEffect)(()=>{let e=d.getFieldValue(l);(null==e?void 0:e.type)&&!c&&m(e.type)},[d,l]);let p=e=>{let a;let o=e.param_type.toLowerCase(),d=[l,e.param_name];return a="str"===o||"string"===o?e.valid_values?(0,t.jsx)(r.default,{children:e.valid_values.map(e=>(0,t.jsx)(r.default.Option,{value:e,children:e},e))}):(0,t.jsx)(i.default,{}):"int"===o||"integer"===o||"number"===o||"float"===o?(0,t.jsx)(n.Z,{className:"w-full"}):"bool"===o||"boolean"===o?(0,t.jsx)(s.Z,{}):(0,t.jsx)(i.default,{}),(0,t.jsx)(u.Z.Item,{label:e.label||e.param_name,name:d,valuePropName:"bool"===o||"boolean"===o?"checked":"value",tooltip:e.description,rules:c&&e.required?[{required:!0,message:"Please input ".concat(e.param_name)}]:[],children:a},e.param_name)};return(0,t.jsxs)("div",{className:"space-y-4 border rounded-md p-4",children:[(0,t.jsx)(u.Z.Item,{label:"Type",name:[l,"type"],children:(0,t.jsx)(r.default,{onChange:e=>{m(e);let t=a[e]||[],r={type:e};t.forEach(e=>{r[e.param_name]=e.default_value}),d.setFieldsValue({[l]:r})},placeholder:"Select a type",children:Object.keys(a).map(e=>(0,t.jsx)(r.default.Option,{value:e,children:e},e))})}),c&&a[c]&&(0,t.jsxs)("div",{className:"mt-4",children:[(0,t.jsxs)("h4",{className:"mb-4 text-base font-medium",children:[c," Configuration"]}),(0,t.jsx)("div",{className:"space-y-4",children:a[c].map(e=>p(e))})]})]})};let c=e=>!!Array.isArray(e)&&0!==e.length&&"object"==typeof e[0]&&null!==e[0]&&"key"in e[0]&&"label"in e[0];var m=function(e){let{params:l,form:a}=e;if((0,o.useEffect)(()=>{if(l){let e={};l.forEach(l=>{if(!l.nested_fields){let t=a.getFieldValue(l.param_name);void 0===t&&(e[l.param_name]=l.default_value)}}),a.setFieldsValue(e)}},[l,a]),!l||(null==l?void 0:l.length)<1)return null;let m=e=>{let a={...e};return null==l||l.forEach(e=>{if(e.nested_fields&&a[e.param_name]){let l=a[e.param_name];if(l.type){let t=e.nested_fields[l.type]||[],r={};t.forEach(e=>{void 0!==l[e.param_name]&&(r[e.param_name]=l[e.param_name])}),a[e.param_name]={type:l.type,...r}}}}),a},p=a.submit;return a.submit=()=>{let e=a.getFieldsValue(),l=m(e);a.setFieldsValue(l),p.call(a)},(0,t.jsx)("div",{className:"space-y-4",children:null==l?void 0:l.map(e=>(0,t.jsx)(u.Z.Item,{label:(0,t.jsx)("p",{className:"whitespace-normal overflow-wrap-break-word",children:e.label||e.param_name}),name:e.param_name,initialValue:e.default_value,valuePropName:"bool"===e.param_type.toLowerCase()||"boolean"===e.param_type.toLowerCase()?"checked":"value",tooltip:e.description,rules:e.required?[{required:!0,message:"Please input ".concat(e.label||e.param_name)}]:[],children:function(e){var l,u,o,m;if(e.nested_fields)return(0,t.jsx)(d,{parentName:e.param_name,fields:e.nested_fields,form:a});let p=e.param_type.toLowerCase(),f=null===(l=e.ext_metadata)||void 0===l?void 0:null===(u=l.tags)||void 0===u?void 0:u.includes("fixed"),v=null===(o=e.ext_metadata)||void 0===o?void 0:null===(m=o.tags)||void 0===m?void 0:m.includes("privacy");return"str"===p||"string"===p?e.valid_values?c(e.valid_values)?(0,t.jsx)(r.default,{disabled:f,children:e.valid_values.map(e=>(0,t.jsx)(r.default.Option,{value:e.key,children:e.label},e.key))}):(0,t.jsx)(r.default,{disabled:f,children:e.valid_values.map(e=>(0,t.jsx)(r.default.Option,{value:e,children:e},e))}):v?(0,t.jsx)(i.default.Password,{disabled:f,autoComplete:"new-password",placeholder:"请输入密码"}):(0,t.jsx)(i.default,{disabled:f}):"int"===p||"integer"===p||"number"===p||"float"===p?(0,t.jsx)(n.Z,{className:"w-full",disabled:f}):"bool"===p||"boolean"===p?(0,t.jsx)(s.Z,{disabled:f}):(0,t.jsx)(i.default,{disabled:f})}(e)},e.param_name))})}},77451:function(e,l,a){a.r(l);var t=a(85893),r=a(60778),i=a(18102),n=a(11475),s=a(65654),u=a(65217),o=a(85576),d=a(99859),c=a(93967),m=a.n(c),p=a(67294),f=a(67421),v=a(57632),x=a(69797);let y=e=>{let{value:l,onChange:a,promptList:r}=e,[s,d]=(0,p.useState)(!1),[c,m]=(0,p.useState)(),{t:v}=(0,f.$G)();return(0,p.useEffect)(()=>{if(l){let e=null==r?void 0:r.filter(e=>e.prompt_code===l)[0];m(e)}},[r,l]),(0,t.jsxs)("div",{className:"w-2/5 flex items-center gap-2",children:[(0,t.jsx)(u.default,{className:"w-1/2",placeholder:v("please_select_prompt"),options:r,fieldNames:{label:"prompt_name",value:"prompt_code"},onChange:e=>{let l=null==r?void 0:r.filter(l=>l.prompt_code===e)[0];m(l),null==a||a(e)},value:l,allowClear:!0,showSearch:!0}),c&&(0,t.jsxs)("span",{className:"text-sm text-blue-500 cursor-pointer",onClick:()=>d(!0),children:[(0,t.jsx)(n.Z,{className:"mr-1"}),v("View_details")]}),(0,t.jsx)(o.default,{title:"Prompt ".concat(v("details")),open:s,footer:!1,width:"60%",onCancel:()=>d(!1),children:(0,t.jsx)(i.default,{children:null==c?void 0:c.content})})]})};l.default=e=>{var l,a;let{name:i,initValue:n,modelStrategyOptions:o,resourceTypeOptions:c,updateData:_,classNames:h,promptList:j}=e,{t:g}=(0,f.$G)(),[b]=d.Z.useForm(),Z=d.Z.useWatch("prompt_template",b),N=d.Z.useWatch("llm_strategy",b),w=d.Z.useWatch("llm_strategy_value",b),k=(0,p.useMemo)(()=>(null==n?void 0:n.find(e=>e.agent_name===i))||[],[n,i]),C=(0,p.useRef)([]),{run:V,loading:E,data:S}=(0,s.Z)(async()=>{var e;let[,l]=await (0,r.Vx)((0,r.m9)("priority"));return null!==(e=null==l?void 0:l.map(e=>({label:e,value:e})))&&void 0!==e?e:[]},{manual:!0});return(0,p.useEffect)(()=>{"priority"===N&&V()},[V,N]),(0,p.useEffect)(()=>{var e;let l=b.getFieldsValue();_({agent_name:i,...l,llm_strategy_value:null==l?void 0:null===(e=l.llm_strategy_value)||void 0===e?void 0:e.join(","),resources:C.current})},[b,E,i,Z,N,w,_]),(0,t.jsx)("div",{className:m()(h),children:(0,t.jsxs)(d.Z,{style:{width:"100%"},labelCol:{span:4},form:b,initialValues:{llm_strategy:"default",...k,llm_strategy_value:null==k?void 0:null===(l=k.llm_strategy_value)||void 0===l?void 0:l.split(",")},children:[(0,t.jsx)(d.Z.Item,{label:g("Prompt"),name:"prompt_template",children:(0,t.jsx)(y,{promptList:j})}),(0,t.jsx)(d.Z.Item,{label:g("LLM_strategy"),required:!0,name:"llm_strategy",children:(0,t.jsx)(u.default,{className:"w-1/5",placeholder:g("please_select_LLM_strategy"),options:o,allowClear:!0})}),"priority"===N&&(0,t.jsx)(d.Z.Item,{label:g("LLM_strategy_value"),required:!0,name:"llm_strategy_value",children:(0,t.jsx)(u.default,{mode:"multiple",className:"w-2/5",placeholder:g("please_select_LLM_strategy_value"),options:S,allowClear:!0})}),(0,t.jsx)(d.Z.Item,{label:g("available_resources"),name:"resources",children:(0,t.jsx)(x.default,{resourceTypeOptions:c,initValue:null==k?void 0:null===(a=k.resources)||void 0===a?void 0:a.map(e=>({...e,uid:(0,v.Z)()})),updateData:e=>{C.current=null==e?void 0:e[1],_({agent_name:i,resources:C.current})},name:i})})]})})}},60952:function(e,l,a){a.r(l);var t=a(85893),r=a(60778),i=a(98198),n=a(99859),s=a(74330),u=a(65217),o=a(72269),d=a(93967),c=a.n(d),m=a(67294),p=a(67421);let f=e=>{if(!e)return{};if("string"==typeof e)try{let l=JSON.parse(e),a={};return Object.keys(l).forEach(e=>{let t=l[e];t&&"object"==typeof t&&null!==t&&"key"in t?a[e]=t.key:a[e]=t}),a}catch(e){return console.error("Failed to parse resource value:",e),{}}if("object"==typeof e){let l={};return Object.keys(e).forEach(a=>{let t=e[a];t&&"object"==typeof t&&null!==t&&"key"in t?l[a]=t.key:l[a]=t}),l}return{}};l.default=e=>{let{uid:l,initValue:a,updateData:d,classNames:v,resourceType:x,resourceTypeOptions:y,setCurIcon:_}=e,[h]=n.Z.useForm(),j=n.Z.useWatch("is_dynamic",h),g=n.Z.useWatch("resource_type",h),{t:b}=(0,p.$G)(),[Z,N]=(0,m.useState)(!1),[w,k]=(0,m.useState)(null),C=(0,m.useRef)(null),V=(0,m.useRef)(""),E=(0,m.useRef)(!1),S=y.filter(e=>"all"!==e.value),F=e=>{e!==g&&(h.resetFields(["is_dynamic"]),_({uid:l,icon:e}),O(e),setTimeout(()=>{I(!0)},800))},O=async e=>{N(!0);try{let[l,a]=await (0,r.Vx)((0,r.i1)({type:e}));if(!l&&a){if(k(a),a.length>0){let l=h.getFieldValue("resource_type"),a=h.getFieldValue("is_dynamic");h.resetFields(),h.setFieldsValue({resource_type:l||e,is_dynamic:a||!1})}}else k(null),console.error("Failed to fetch resource params:",l)}catch(e){console.error("Error fetching resource params:",e),k(null)}finally{N(!1),e!==g&&g||setTimeout(()=>{I(!0)},500)}};(0,m.useEffect)(()=>{w&&E.current&&g&&setTimeout(()=>{I(!0)},300)},[w,g]),(0,m.useEffect)(()=>{x&&(h.setFieldsValue({resource_type:x}),O(x),_({uid:l,icon:x}))},[x,l,_]),(0,m.useEffect)(()=>{if(w&&a&&!E.current)try{let e=f(a.value);h.setFields(Object.entries({resource_type:x,is_dynamic:a.is_dynamic,...e}).map(e=>{let[l,a]=e;return{name:l,value:a,touched:!1,validating:!1}})),E.current=!0,setTimeout(()=>{I(!0)},500)}catch(e){console.error("Error setting initial values:",e)}},[w,a,h,x]);let I=function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];C.current&&(clearTimeout(C.current),C.current=null),C.current=setTimeout(()=>{let t=h.getFieldsValue(),r=t.resource_type;if(!r)return;let i={...t};w&&w.forEach(e=>{if(e.valid_values&&Array.isArray(e.valid_values)&&e.valid_values.length>0&&"object"==typeof e.valid_values[0]&&i[e.param_name]){let l=i[e.param_name];"string"!=typeof l&&(i[e.param_name]=l.key||l)}});let{resource_type:n,is_dynamic:s,...u}=i,o=j?"":JSON.stringify(u),c=JSON.stringify({type:r,is_dynamic:!!j,value:o});(e||c!==V.current)&&(V.current=c,d({uid:l,type:r,is_dynamic:!!j,value:o,name:(null==a?void 0:a.name)||b("resource")}))},300)};return(0,t.jsx)("div",{className:c()("flex flex-1",v),children:(0,t.jsx)(s.Z,{spinning:Z,children:(0,t.jsxs)(n.Z,{style:{width:"100%"},form:h,labelCol:{span:7},initialValues:{resource_type:x,is_dynamic:(null==a?void 0:a.is_dynamic)||!1},onValuesChange:e=>{if("resource_type"in e){F(e.resource_type);return}if("is_dynamic"in e){I(!0);return}let l=Object.keys(e);l.length>0?h.validateFields(l).then(()=>{console.log("Field validation success"),I()}).catch(e=>{console.log("Field validation error, but still updating:",e),I()}):I()},children:[(0,t.jsx)(n.Z.Item,{label:b("resource_type"),name:"resource_type",rules:[{required:!0,message:b("please_select_resource_type")}],children:(0,t.jsx)(u.default,{options:S,placeholder:b("please_select_resource_type")})}),(0,t.jsx)(n.Z.Item,{label:b("resource_dynamic"),name:"is_dynamic",valuePropName:"checked",children:(0,t.jsx)(o.Z,{style:{background:j?"#1677ff":"#ccc"}})}),!j&&w&&(0,t.jsx)(i.Z,{params:w,form:h})]})})})}},69797:function(e,l,a){a.r(l);var t=a(85893),r=a(91085),i=a(48689),n=a(24969),s=a(65217),u=a(25593),o=a(86738),d=a(77683),c=a(93967),m=a.n(c),p=a(96486),f=a(67294),v=a(67421),x=a(57632),y=a(83072),_=a(60952);l.default=e=>{var l;let{name:a,updateData:c,resourceTypeOptions:h,initValue:j}=e,{t:g}=(0,v.$G)(),b=(0,f.useRef)(j||[]),[Z,N]=(0,f.useState)({uid:"",icon:""}),w=(0,f.useRef)(""),[k,C]=(0,f.useState)((null==j?void 0:j.map(e=>({...e,icon:e.type,initVal:e})))||[]),[V,E]=(0,f.useState)([...k]),[S,F]=(0,f.useState)((null==k?void 0:null===(l=k[0])||void 0===l?void 0:l.uid)||""),[O,I]=(0,f.useState)(""),T=(e,l)=>{null==e||e.stopPropagation();let t=k.findIndex(e=>e.uid===S),r=null==k?void 0:k.filter(e=>e.uid!==l.uid);b.current=b.current.filter(e=>e.uid!==l.uid)||[];let i=[a,b.current],n=JSON.stringify(i);if(n!==w.current&&(w.current=n,c(i)),C(r),l.uid===S){var s,u;if(t===k.length-1&&0!==t)F((null==r?void 0:null===(s=r[r.length-1])||void 0===s?void 0:s.uid)||"");else{let e=Math.min(t,r.length-1);F((null==r?void 0:null===(u=r[e])||void 0===u?void 0:u.uid)||"")}}};return(0,f.useEffect)(()=>{Z.uid&&Z.icon&&C(k.map(e=>(null==Z?void 0:Z.uid)===e.uid?{...e,icon:Z.icon,type:Z.icon}:e))},[Z]),(0,f.useEffect)(()=>{E([...k])},[k]),(0,t.jsxs)("div",{className:"flex flex-1 px-3 py-4 border border-[#d6d8da] rounded-md",style:{minHeight:"450px"},children:[(0,t.jsxs)("div",{className:"flex flex-col w-40 h-full",children:[(0,t.jsx)(s.default,{options:h,className:"w-full h-8",variant:"borderless",defaultValue:"all",onChange:e=>{var l,a;if("all"===e)E(k),F((null==k?void 0:null===(l=k[0])||void 0===l?void 0:l.uid)||"");else{let l=null==k?void 0:k.filter(l=>(null==l?void 0:l.icon)===e);F((null==l?void 0:null===(a=l[0])||void 0===a?void 0:a.uid)||""),E(l)}}}),(0,t.jsx)("div",{className:"flex flex-1 flex-col gap-1 overflow-y-auto",children:null==V?void 0:V.map(e=>(0,t.jsxs)("div",{className:m()("flex h-8 items-center px-3 pl-[0.6rem] rounded-md hover:bg-[#f5faff] hover:dark:bg-[#606264] cursor-pointer relative",{"bg-[#f5faff] dark:bg-[#606264]":e.uid===S}),onClick:()=>{F(e.uid||"")},onMouseEnter:()=>{I(e.uid||"")},onMouseLeave:()=>{I("")},children:[y.resourceTypeIcon[e.icon||""],(0,t.jsx)(u.Z.Text,{className:m()("flex flex-1 items-center text-sm p-0 m-0 mx-2 line-clamp-1",{"text-[#0c75fc]":e.uid===S}),editable:{autoSize:{maxRows:1},onChange:l=>{let t=k.map(a=>a.uid===e.uid?{...a,name:l}:a);C(t),b.current=b.current.map(a=>a.uid===e.uid?{...a,name:l}:a);let r=[a,b.current],i=JSON.stringify(r);i!==w.current&&(w.current=i,c(r))}},ellipsis:{tooltip:!0},children:e.name}),(0,t.jsx)(o.Z,{title:g("want_delete"),onConfirm:l=>{T(l,e)},onCancel:e=>null==e?void 0:e.stopPropagation(),children:(0,t.jsx)(i.Z,{className:"text-sm cursor-pointer absolute right-2 ".concat(O===e.uid?"opacity-100":"opacity-0"),style:{top:"50%",transform:"translateY(-50%)"},onClick:e=>e.stopPropagation()})})]},e.uid))}),(0,t.jsx)(d.ZP,{className:"w-full h-8",type:"dashed",block:!0,icon:(0,t.jsx)(n.Z,{}),onClick:()=>{var e,l;let t=(0,x.Z)(),r=(null===(e=null==h?void 0:h.filter(e=>"all"!==e.value))||void 0===e?void 0:null===(l=e[0])||void 0===l?void 0:l.value)||"",i={is_dynamic:!1,type:r,value:"",uid:t,name:g("resource")+" ".concat(b.current.length+1)};b.current=(0,p.concat)(b.current,[i]);let n=[a,b.current],s=JSON.stringify(n);s!==w.current&&(w.current=s,c(n)),C(e=>[...e,{icon:r,type:r,uid:t,initVal:i,name:g("resource")+" ".concat(e.length+1)}]),F(t),N({uid:t,icon:r})},children:g("add_resource")})]}),(0,t.jsx)("div",{className:"flex flex-1 ml-6",style:{minHeight:"430px",overflowY:"auto"},children:V&&(null==V?void 0:V.length)>0?(0,t.jsx)("div",{className:"flex flex-1",children:null==V?void 0:V.map(e=>(0,t.jsx)(_.default,{classNames:e.uid===S?"block":"hidden",initValue:e.initVal,resourceType:e.icon||"",resourceTypeOptions:h,setCurIcon:N,updateData:e=>{var l;b.current=null===(l=b.current)||void 0===l?void 0:l.map(l=>(null==l?void 0:l.uid)===(null==e?void 0:e.uid)?{...l,...e}:l);let t=[a,b.current],r=JSON.stringify(t);r!==w.current&&(w.current=r,c(t))},uid:e.uid||""},e.uid))}):(0,t.jsx)(r.Z,{className:"w-40 h-40"})})]})}},83072:function(e,l,a){a.r(l),a.d(l,{agentIcon:function(){return j},resourceTypeIcon:function(){return g}});var t=a(85893),r=a(70065),i=a(89035),n=a(48869),s=a(61086),u=a(57132),o=a(97879),d=a(32319),c=a(79383),m=a(13520),p=a(14079),f=a(10524),v=a(56466),x=a(26911),y=a(97175),_=a(16801),h=a(13179);a(67294);let j={CodeEngineer:(0,t.jsx)(i.Z,{}),Reporter:(0,t.jsx)(n.Z,{}),DataScientist:(0,t.jsx)(s.Z,{}),Summarizer:(0,t.jsx)(u.Z,{}),ToolExpert:(0,t.jsx)(r.Z,{type:"icon-plugin",style:{fontSize:17.25,marginTop:2}}),Indicator:(0,t.jsx)(o.Z,{}),Dbass:(0,t.jsx)(d.Z,{})},g={all:(0,t.jsx)(c.Z,{}),database:(0,t.jsx)(m.Z,{}),knowledge:(0,t.jsx)(p.Z,{}),internet:(0,t.jsx)(f.Z,{}),plugin:(0,t.jsx)(v.Z,{}),text_file:(0,t.jsx)(x.Z,{}),excel_file:(0,t.jsx)(y.Z,{}),image_file:(0,t.jsx)(_.Z,{}),awel_flow:(0,t.jsx)(h.Z,{})};l.default=()=>(0,t.jsx)(t.Fragment,{})}}]);