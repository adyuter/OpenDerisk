(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1113],{24969:function(e,t,a){"use strict";a.d(t,{Z:function(){return i}});var l=a(87462),s=a(67294),n={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M482 152h60q8 0 8 8v704q0 8-8 8h-60q-8 0-8-8V160q0-8 8-8z"}},{tag:"path",attrs:{d:"M192 474h672q8 0 8 8v60q0 8-8 8H160q-8 0-8-8v-60q0-8 8-8z"}}]},name:"plus",theme:"outlined"},r=a(84089),i=s.forwardRef(function(e,t){return s.createElement(r.Z,(0,l.Z)({},e,{ref:t,icon:n}))})},33507:function(e,t){"use strict";t.Z=e=>({[e.componentCls]:{[`${e.antCls}-motion-collapse-legacy`]:{overflow:"hidden","&-active":{transition:`height ${e.motionDurationMid} ${e.motionEaseInOut},
        opacity ${e.motionDurationMid} ${e.motionEaseInOut} !important`}},[`${e.antCls}-motion-collapse`]:{overflow:"hidden",transition:`height ${e.motionDurationMid} ${e.motionEaseInOut},
        opacity ${e.motionDurationMid} ${e.motionEaseInOut} !important`}}})},47329:function(e,t,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/construct/models",function(){return a(65801)}])},81799:function(e,t,a){"use strict";a.d(t,{A:function(){return u}});var l=a(85893),s=a(41468),n=a(19284),r=a(65217),i=a(25675),o=a.n(i),d=a(67294),c=a(67421);let m="/models/huggingface.svg";function u(e,t){var a,s;let{width:r,height:i}=t||{};return e?(0,l.jsx)(o(),{className:"rounded-full border border-gray-200 object-contain bg-white inline-block",width:r||24,height:i||24,src:(null===(a=n.Hf[e])||void 0===a?void 0:a.icon)||m,alt:"llm"},(null===(s=n.Hf[e])||void 0===s?void 0:s.icon)||m):null}t.Z=function(e){let{onChange:t}=e,{t:a}=(0,c.$G)(),{modelList:i,model:o}=(0,d.useContext)(s.p);return!i||i.length<=0?null:(0,l.jsx)(r.default,{value:o,placeholder:a("choose_model"),className:"w-52",onChange:e=>{null==t||t(e)},children:i.map(e=>{var t;return(0,l.jsx)(r.default.Option,{children:(0,l.jsxs)("div",{className:"flex items-center",children:[u(e),(0,l.jsx)("span",{className:"ml-2",children:(null===(t=n.Hf[e])||void 0===t?void 0:t.label)||e})]})},e)})})}},98198:function(e,t,a){"use strict";a.d(t,{Z:function(){return u}});var l=a(85893),s=a(65217),n=a(38289),r=a(24435),i=a(84567),o=a(99859),d=a(67294),c=e=>{let{parentName:t,fields:a,form:c}=e,[m,u]=(0,d.useState)(null);(0,d.useEffect)(()=>{let e=c.getFieldValue(t);(null==e?void 0:e.type)&&!m&&u(e.type)},[c,t]);let p=e=>{let a;let d=e.param_type.toLowerCase(),c=[t,e.param_name];return a="str"===d||"string"===d?e.valid_values?(0,l.jsx)(s.default,{children:e.valid_values.map(e=>(0,l.jsx)(s.default.Option,{value:e,children:e},e))}):(0,l.jsx)(n.default,{}):"int"===d||"integer"===d||"number"===d||"float"===d?(0,l.jsx)(r.Z,{className:"w-full"}):"bool"===d||"boolean"===d?(0,l.jsx)(i.Z,{}):(0,l.jsx)(n.default,{}),(0,l.jsx)(o.Z.Item,{label:e.label||e.param_name,name:c,valuePropName:"bool"===d||"boolean"===d?"checked":"value",tooltip:e.description,rules:m&&e.required?[{required:!0,message:"Please input ".concat(e.param_name)}]:[],children:a},e.param_name)};return(0,l.jsxs)("div",{className:"space-y-4 border rounded-md p-4",children:[(0,l.jsx)(o.Z.Item,{label:"Type",name:[t,"type"],children:(0,l.jsx)(s.default,{onChange:e=>{u(e);let l=a[e]||[],s={type:e};l.forEach(e=>{s[e.param_name]=e.default_value}),c.setFieldsValue({[t]:s})},placeholder:"Select a type",children:Object.keys(a).map(e=>(0,l.jsx)(s.default.Option,{value:e,children:e},e))})}),m&&a[m]&&(0,l.jsxs)("div",{className:"mt-4",children:[(0,l.jsxs)("h4",{className:"mb-4 text-base font-medium",children:[m," Configuration"]}),(0,l.jsx)("div",{className:"space-y-4",children:a[m].map(e=>p(e))})]})]})};let m=e=>!!Array.isArray(e)&&0!==e.length&&"object"==typeof e[0]&&null!==e[0]&&"key"in e[0]&&"label"in e[0];var u=function(e){let{params:t,form:a}=e;if((0,d.useEffect)(()=>{if(t){let e={};t.forEach(t=>{if(!t.nested_fields){let l=a.getFieldValue(t.param_name);void 0===l&&(e[t.param_name]=t.default_value)}}),a.setFieldsValue(e)}},[t,a]),!t||(null==t?void 0:t.length)<1)return null;let u=e=>{let a={...e};return null==t||t.forEach(e=>{if(e.nested_fields&&a[e.param_name]){let t=a[e.param_name];if(t.type){let l=e.nested_fields[t.type]||[],s={};l.forEach(e=>{void 0!==t[e.param_name]&&(s[e.param_name]=t[e.param_name])}),a[e.param_name]={type:t.type,...s}}}}),a},p=a.submit;return a.submit=()=>{let e=a.getFieldsValue(),t=u(e);a.setFieldsValue(t),p.call(a)},(0,l.jsx)("div",{className:"space-y-4",children:null==t?void 0:t.map(e=>(0,l.jsx)(o.Z.Item,{label:(0,l.jsx)("p",{className:"whitespace-normal overflow-wrap-break-word",children:e.label||e.param_name}),name:e.param_name,initialValue:e.default_value,valuePropName:"bool"===e.param_type.toLowerCase()||"boolean"===e.param_type.toLowerCase()?"checked":"value",tooltip:e.description,rules:e.required?[{required:!0,message:"Please input ".concat(e.label||e.param_name)}]:[],children:function(e){var t,o,d,u;if(e.nested_fields)return(0,l.jsx)(c,{parentName:e.param_name,fields:e.nested_fields,form:a});let p=e.param_type.toLowerCase(),h=null===(t=e.ext_metadata)||void 0===t?void 0:null===(o=t.tags)||void 0===o?void 0:o.includes("fixed"),f=null===(d=e.ext_metadata)||void 0===d?void 0:null===(u=d.tags)||void 0===u?void 0:u.includes("privacy");return"str"===p||"string"===p?e.valid_values?m(e.valid_values)?(0,l.jsx)(s.default,{disabled:h,children:e.valid_values.map(e=>(0,l.jsx)(s.default.Option,{value:e.key,children:e.label},e.key))}):(0,l.jsx)(s.default,{disabled:h,children:e.valid_values.map(e=>(0,l.jsx)(s.default.Option,{value:e,children:e},e))}):f?(0,l.jsx)(n.default.Password,{disabled:h,autoComplete:"new-password",placeholder:"请输入密码"}):(0,l.jsx)(n.default,{disabled:h}):"int"===p||"integer"===p||"number"===p||"float"===p?(0,l.jsx)(r.Z,{className:"w-full",disabled:h}):"bool"===p||"boolean"===p?(0,l.jsx)(i.Z,{disabled:h}):(0,l.jsx)(n.default,{disabled:h})}(e)},e.param_name))})}},48218:function(e,t,a){"use strict";var l=a(85893),s=a(82353),n=a(16165),r=a(67294);t.Z=e=>{let{width:t,height:a,scene:i}=e,o=(0,r.useCallback)(()=>{switch(i){case"chat_knowledge":return s.je;case"chat_with_db_execute":return s.zM;case"chat_excel":return s.DL;case"chat_with_db_qa":case"chat_dba":return s.RD;case"chat_dashboard":return s.In;case"chat_agent":return s.si;case"chat_normal":return s.O7;default:return}},[i]);return(0,l.jsx)(n.Z,{className:"w-".concat(t||7," h-").concat(a||7),component:o()})}},91467:function(e,t,a){"use strict";a.d(t,{TH:function(){return f},ZS:function(){return x}});var l=a(85893),s=a(89705),n=a(83062),r=a(96074),i=a(25593),o=a(85418),d=a(93967),c=a.n(d),m=a(36609),u=a(25675),p=a.n(u);a(67294);var h=a(48218);a(11873);let f=e=>{let{onClick:t,Icon:a="/pictures/card_chat.png",text:s=(0,m.t)("start_chat")}=e;return"string"==typeof a&&(a=(0,l.jsx)(p(),{src:a,alt:a,width:17,height:15})),(0,l.jsxs)("div",{className:"flex items-center gap-1 text-default",onClick:e=>{e.stopPropagation(),t&&t()},children:[a,(0,l.jsx)("span",{children:s})]})},x=e=>{let{menu:t}=e;return(0,l.jsx)(o.Z,{menu:t,getPopupContainer:e=>e.parentNode,placement:"bottomRight",autoAdjustOverflow:!1,children:(0,l.jsx)(s.Z,{className:"p-2 hover:bg-white hover:dark:bg-black rounded-md"})})};t.ZP=e=>{let{RightTop:t,Tags:a,LeftBottom:s,RightBottom:o,onClick:d,rightTopHover:m=!0,logo:u,name:f,description:x,className:v,scene:_,code:j}=e;return"string"==typeof x&&(x=(0,l.jsx)("p",{className:"line-clamp-2 relative bottom-4 text-ellipsis min-h-[42px] text-sm text-[#525964] dark:text-[rgba(255,255,255,0.65)]",children:x})),(0,l.jsx)("div",{className:c()("hover-underline-gradient flex justify-center mt-6 relative group w-1/3 px-2 mb-6",v),children:(0,l.jsxs)("div",{onClick:d,className:"backdrop-filter backdrop-blur-lg cursor-pointer  bg-white bg-opacity-70 border-2 border-white rounded-lg shadow p-4 relative w-full h-full dark:border-[#6f7f95] dark:bg-[#6f7f95] dark:bg-opacity-60",children:[(0,l.jsxs)("div",{className:"flex items-end relative bottom-8 justify-between w-full",children:[(0,l.jsxs)("div",{className:"flex items-end gap-4 w-11/12  flex-1",children:[(0,l.jsx)("div",{className:"bg-white rounded-lg shadow-sm w-14 h-14 flex items-center p-3",children:_?(0,l.jsx)(h.Z,{scene:_,width:14,height:14}):u&&(0,l.jsx)(p(),{src:u,width:44,height:44,alt:f,className:"w-8 min-w-8 rounded-full max-w-none"})}),(0,l.jsx)("div",{className:"flex-1",children:f.length>6?(0,l.jsx)(n.Z,{title:f,children:(0,l.jsx)("span",{className:"line-clamp-1 text-ellipsis font-semibold text-base",style:{maxWidth:"60%"},children:f})}):(0,l.jsx)("span",{className:"line-clamp-1 text-ellipsis font-semibold text-base",style:{maxWidth:"60%"},children:f})})]}),(0,l.jsx)("span",{className:c()("shrink-0",{hidden:m,"group-hover:block":m}),onClick:e=>{e.stopPropagation()},children:t})]}),x,(0,l.jsx)("div",{className:"relative bottom-2",children:a}),(0,l.jsxs)("div",{className:"flex justify-between items-center",children:[(0,l.jsx)("div",{children:s}),(0,l.jsx)("div",{children:o})]}),j&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(r.Z,{className:"my-3"}),(0,l.jsx)(i.Z.Text,{copyable:!0,className:"absolute bottom-1 right-4 text-xs text-gray-500",children:j})]})]})})}},65801:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return M}});var l=a(85893),s=a(60778),n=a(81799),r=a(65217),i=a(99859),o=a(45360),d=a(98423),c=a(8745),m=a(67294),u=a(93967),p=a.n(u),h=a(50344),f=a(87263),x=a(53124);let{Option:v}=r.default;function _(e){return(null==e?void 0:e.type)&&(e.type.isSelectOption||e.type.isSelectOptGroup)}let j=m.forwardRef((e,t)=>{var a;let l,s;let{prefixCls:n,className:i,popupClassName:o,dropdownClassName:c,children:u,dataSource:j}=e,b=(0,h.Z)(u);1===b.length&&m.isValidElement(b[0])&&!_(b[0])&&([l]=b);let y=l?()=>l:void 0;s=b.length&&_(b[0])?u:j?j.map(e=>{if(m.isValidElement(e))return e;switch(typeof e){case"string":return m.createElement(v,{key:e,value:e},e);case"object":{let{value:t}=e;return m.createElement(v,{key:t,value:t},e.text)}default:return}}):[];let{getPrefixCls:g}=m.useContext(x.E_),w=g("select",n),[N]=(0,f.Cn)("SelectLike",null===(a=e.dropdownStyle)||void 0===a?void 0:a.zIndex);return m.createElement(r.default,Object.assign({ref:t,suffixIcon:null},(0,d.Z)(e,["dataSource","dropdownClassName"]),{prefixCls:w,popupClassName:o||c,dropdownStyle:Object.assign(Object.assign({},e.dropdownStyle),{zIndex:N}),className:p()(`${w}-auto-complete`,i),mode:r.default.SECRET_COMBOBOX_MODE_DO_NOT_USE,getInputElement:y}),s)}),{Option:b}=r.default,y=(0,c.Z)(j,"dropdownAlign",e=>(0,d.Z)(e,["visible"]));j.Option=b,j._InternalPanelDoNotUseOrYouWillBeFired=y;var g=a(83062),w=a(77683),N=a(67421),k=a(27426),Z=a(98198);let{Option:C}=r.default,O=i.Z.Item,E=["llm","text2vec","reranker"];var S=function(e){var t;let{onCancel:a,onSuccess:d}=e,{t:c}=(0,N.$G)(),[u,p]=(0,m.useState)([]),[h,f]=(0,m.useState)(),[x,v]=(0,m.useState)(),[_,b]=(0,m.useState)(null),[y,S]=(0,m.useState)(!1),[P]=i.Z.useForm(),[V,q]=(0,m.useState)({}),[F,$]=(0,m.useState)([]);async function H(){let[,e]=await (0,s.Vx)((0,s.xv)());if(e&&e.length){let t=e.sort((e,t)=>e.enabled&&!t.enabled?-1:!e.enabled&&t.enabled?1:e.model.localeCompare(t.model));p(t);let a=t.reduce((e,t)=>{let a=t.provider;return e[a]||(e[a]=[]),e[a].push(t),e},{});q(a),$([])}}async function I(e){if(x&&h){S(!0);try{var t;let a=(e=>{let t={...e};return null==_||_.forEach(e=>{if(e.nested_fields&&t[e.param_name]){let a=t[e.param_name];if(a.type){let l=e.nested_fields[a.type]||[],s={};l.forEach(e=>{void 0!==a[e.param_name]&&(s[e.param_name]=a[e.param_name])}),t[e.param_name]={...s,type:a.type}}}}),t})(e),l=null===(t=V[x])||void 0===t?void 0:t.find(e=>e.model===a.name),n={host:(null==l?void 0:l.host)||"",port:(null==l?void 0:l.port)||0,model:a.name,worker_type:h,params:a},[,,r]=await (0,s.Vx)((0,s.NY)(n));(null==r?void 0:r.success)&&(o.ZP.success(c("start_model_success")),P.resetFields(),null==d||d())}catch(e){o.ZP.error(c("start_model_failed"))}finally{S(!1)}}}(0,m.useEffect)(()=>{H()},[]);let M=e=>(0,l.jsxs)("div",{className:"max-w-md",children:[(0,l.jsx)("div",{className:"whitespace-pre-wrap markdown-body",children:(0,l.jsx)(k.UG,{children:e.description||e.model})}),(0,l.jsx)("div",{className:"mt-2 text-xs opacity-75",children:e.enabled?"".concat(e.host,":").concat(e.port):c("download_model_tip")})]});return(0,l.jsxs)(i.Z,{form:P,labelCol:{span:8},wrapperCol:{span:16},onFinish:I,children:[(0,l.jsx)(O,{label:"Worker Type",name:"worker_type",rules:[{required:!0,message:c("worker_type_select_tips")}],children:(0,l.jsx)(r.default,{onChange:function(e){f(e),v(void 0),P.resetFields(),P.setFieldValue("worker_type",e),function(e){let t=new Set;Object.entries(V).forEach(a=>{let[l,s]=a;s.some(t=>t.worker_type===e)&&t.add(l)}),$(Array.from(t).sort())}(e)},placeholder:c("model_select_worker_type"),children:E.map(e=>(0,l.jsx)(C,{value:e,children:e},e))})}),h&&(0,l.jsx)(O,{label:"Provider",name:"provider",rules:[{required:!0,message:c("provider_select_tips")}],children:(0,l.jsx)(r.default,{onChange:function(e){v(e),P.setFieldValue("provider",e);let t=V[e]||[],a=t.filter(e=>e.worker_type===h);if(a.length>0){let e=a[0];(null==e?void 0:e.params)&&b(Array.isArray(e.params)?e.params:[e.params])}},placeholder:c("model_select_provider"),value:x,children:F.map(e=>(0,l.jsx)(C,{value:e,children:e},e))})}),x&&h&&_&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(O,{label:c("model_deploy_name"),name:"name",rules:[{required:!0,message:c("model_please_input_name")}],children:(0,l.jsx)(j,{style:{width:"100%"},placeholder:c("model_select_or_input_model"),options:null===(t=V[x])||void 0===t?void 0:t.filter(e=>e.worker_type===h).map(e=>({value:e.model,label:(0,l.jsx)("div",{className:"flex items-center w-full",children:(0,l.jsxs)("div",{className:"flex items-center",children:[(0,n.A)(e.model),(0,l.jsx)(g.Z,{title:M(e),placement:"right",children:(0,l.jsx)("span",{className:"ml-2",children:e.model})})]})})})),filterOption:(e,t)=>-1!==t.value.toUpperCase().indexOf(e.toUpperCase())})}),(0,l.jsx)(Z.Z,{params:_.filter(e=>"name"!==e.param_name),form:P})]}),(0,l.jsxs)("div",{className:"flex justify-center space-x-4",children:[(0,l.jsx)(w.ZP,{type:"primary",htmlType:"submit",loading:y,children:c("submit")}),(0,l.jsx)(w.ZP,{onClick:a,children:c("cancel")})]})]})},P=a(91467),V=a(19284),q=a(24969),F=a(85576),$=a(66309),H=a(30381),I=a.n(H),M=function(){let{t:e}=(0,N.$G)(),[t,a]=(0,m.useState)([]),[n,r]=(0,m.useState)(!1),[i,d]=(0,m.useState)(!1);async function c(){let[,e]=await (0,s.Vx)((0,s.fZ)());a(null!=e?e:[])}async function u(t){if(i)return;let a=e("confirm_start_model")+t.model_name;h(e("start_model"),a,async()=>{d(!0);let[,,a]=await (0,s.Vx)((0,s.vA)({host:t.host,port:t.port,model:t.model_name,worker_type:t.worker_type,delete_after:!1,params:{}}));d(!1),(null==a?void 0:a.success)&&(o.ZP.success(e("start_model_success")),await c())})}async function p(t){let a=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(i)return;let l=a?"stop_and_delete":"stop",n=e("confirm_".concat(l,"_model"))+t.model_name;h(e("".concat(l,"_model")),n,async()=>{d(!0);let[,,n]=await (0,s.Vx)((0,s.kU)({host:t.host,port:t.port,model:t.model_name,worker_type:t.worker_type,delete_after:a,params:{}}));d(!1),(null==n?void 0:n.success)===!0&&(o.ZP.success(e("".concat(l,"_model_success"))),await c())})}let h=(e,t,a)=>{F.default.confirm({title:e,content:t,onOk:async()=>{await a()},okButtonProps:{className:"bg-button-gradient"}})};(0,m.useEffect)(()=>{c()},[]);let f=e=>(0,V.ab)(e);return(0,l.jsxs)("div",{className:"page-body p-4 md:p-6 h-[90vh] overflow-auto",children:[(0,l.jsx)("div",{className:"flex justify-between items-center mb-6",children:(0,l.jsx)("div",{className:"flex items-center gap-4",children:(0,l.jsx)(w.ZP,{className:"border-none bg-button-gradient",icon:(0,l.jsx)(q.Z,{}),onClick:()=>{r(!0)},children:e("create_model")})})}),(0,l.jsx)("div",{className:"flex flex-wrap mx-[-8px] ",children:t.map(t=>(0,l.jsx)(P.ZP,{logo:f(t.model_name),description:(0,l.jsxs)("div",{className:"flex flex-col gap-1 relative text-xs bottom-4",children:[(0,l.jsxs)("div",{className:"flex overflow-hidden",children:[(0,l.jsx)("p",{className:"w-28 text-gray-500 mr-2",children:"Host:"}),(0,l.jsx)("p",{className:"flex-1 text-ellipsis",children:t.host})]}),(0,l.jsxs)("div",{className:"flex overflow-hidden",children:[(0,l.jsx)("p",{className:"w-28 text-gray-500 mr-2",children:"Manage Host:"}),(0,l.jsxs)("p",{className:"flex-1 text-ellipsis",children:[t.manager_host,":",t.manager_port]})]}),(0,l.jsxs)("div",{className:"flex overflow-hidden",children:[(0,l.jsx)("p",{className:"w-28 text-gray-500 mr-2",children:"Last Heart Beat:"}),(0,l.jsx)("p",{className:"flex-1 text-ellipsis",children:I()(t.last_heartbeat).format("YYYY-MM-DD HH:mm:ss")})]})]}),name:t.model_name,RightTop:(0,l.jsx)(P.ZS,{menu:{items:[{key:"stop_model",label:(0,l.jsx)("span",{className:"text-red-400",onClick:()=>p(t),children:e("stop_model")})},{key:"start_model",label:(0,l.jsx)("span",{className:"text-green-400",onClick:()=>u(t),children:e("start_model")})},{key:"stop_and_delete_model",label:(0,l.jsx)("span",{className:"text-red-400",onClick:()=>p(t,!0),children:e("stop_and_delete_model")})}]}}),rightTopHover:!1,Tags:(0,l.jsxs)("div",{children:[(0,l.jsx)($.Z,{color:t.healthy?"green":"red",children:t.healthy?"Healthy":"Unhealthy"}),(0,l.jsx)($.Z,{children:t.worker_type})]})},t.model_name))}),(0,l.jsx)(F.default,{width:800,open:n,title:e("create_model"),onCancel:()=>{r(!1)},footer:null,children:(0,l.jsx)(S,{onCancel:()=>{r(!1)},onSuccess:()=>{r(!1),c()}})})]})}},11873:function(){}},function(e){e.O(0,[1449,8289,3791,5217,8791,5593,3886,4435,6877,9859,4567,7426,9774,2888,179],function(){return e(e.s=47329)}),_N_E=e.O()}]);